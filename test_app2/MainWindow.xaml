<Window x:Class="test_app2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:custom="clr-namespace:System.IO.Ports;assembly=System"
        xmlns:viewmodels="clr-namespace:test_app2.ViewModels"
        xmlns:Converters="clr-namespace:test_app2.Converters"
        xmlns:System="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Closing="Window_Closing"
        Title="Aboba" Height="720" Width="1280">
    <Window.Resources>
        <ObjectDataProvider x:Key="PortSettingsViewModel" 
                            MethodName="GetValues"
                            ObjectType="{x:Type System:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="custom:Parity"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <Converters:BoolToIsConnectedConverter x:Key="BoolToIsConnectedConverter"/>
    </Window.Resources>
    <Window.DataContext>
        <viewmodels:MainViewModel/>
    </Window.DataContext>
    <Grid Margin="5">
        <Grid HorizontalAlignment="Left" Width="318" Margin="0,0,0,380">
            <Button  x:Name="COMOpenClosePortButton" 
                     Command="{Binding SerialPort.AutoConnectDisconnectCommand, Mode=OneTime}"
                     Content="{Binding SerialPort.IsConnected, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource BoolToIsConnectedConverter}}" 
                     HorizontalAlignment="Left" VerticalAlignment="Top" Height="22"
                 Margin="227,44,0,0" Width="83" Background="#FFA5D6A7"
                 BorderBrush="#FF388E3C" Foreground="#FF1B5E20" BorderThickness="0,0,0,0"/>
            <Button x:Name="COMRefreshButton" Content="Обновить" HorizontalAlignment="Left" Margin="227,7,0,0" VerticalAlignment="Top" BorderThickness ="0,0,0,0" Height="22" Width="83"
                    Background="#FFA5D6A7" BorderBrush="#FF388E3C" Foreground="#FF1B5E20"/>
            <TextBlock x:Name="COMConnectionTextBlock" HorizontalAlignment="Left" Margin="10,10,0,0" TextWrapping="Wrap" Text="COM-порт:" VerticalAlignment="Top"/>
            <TextBlock x:Name="COMBaudRateTextBlock" HorizontalAlignment="Left" Margin="10,45,0,0" TextWrapping="Wrap" Text="Скорость, бод/c:" VerticalAlignment="Top"/>
            <TextBlock x:Name="COMDataRateTextBlock" HorizontalAlignment="Left" Margin="10,80,0,0" TextWrapping="Wrap" Text="Биты данных :" VerticalAlignment="Top"/>
            <TextBlock x:Name="COMStopBitsTextBlock" HorizontalAlignment="Left" Margin="10,115,0,0" TextWrapping="Wrap" Text="Стоп-биты :" VerticalAlignment="Top"/>
            <TextBlock x:Name="COMParityBitsTextBlock" HorizontalAlignment="Left" Margin="10,150,0,0" TextWrapping="Wrap" Text="Биты чётности :" VerticalAlignment="Top"/>
            <ComboBox x:Name="COMPortsComboBox"
                      ItemsSource="{Binding SerialPort.Settings.AvaliablePorts, Mode=OneTime}"
                      SelectedItem="{Binding SerialPort.Settings.SelectedCOMPort, UpdateSourceTrigger=PropertyChanged}"
                      HorizontalAlignment="Left" Margin="112,7,0,0" VerticalAlignment="Top" Width="90"/>
            <ComboBox x:Name="COMBaudRatesComboBox" 
                      ItemsSource="{Binding SerialPort.Settings.BaudRates, Mode=OneTime}"
                      SelectedValue="{Binding SerialPort.Settings.SelectedBaudRate, UpdateSourceTrigger=PropertyChanged}"
                      HorizontalAlignment="Left" Margin="112,42,0,0" VerticalAlignment="Top" Width="90"/>
            <ComboBox x:Name="COMDataRatesComboBox" 
                      ItemsSource="{Binding SerialPort.Settings.DataBits, Mode=OneTime}"
                      SelectedValue="{Binding SerialPort.Settings.SelectedDataBits, UpdateSourceTrigger=PropertyChanged}"
                      HorizontalAlignment="Left" Margin="112,77,0,0" VerticalAlignment="Top" Width="90"/>
            <ComboBox x:Name="COMStopBitsComboBox" 
                      ItemsSource="{Binding SerialPort.Settings.StopBits, Mode=OneTime}"
                      SelectedValue="{Binding SerialPort.Settings.SelectedStopBits, UpdateSourceTrigger=PropertyChanged}"
                      HorizontalAlignment="Left" Margin="112,112,0,0" VerticalAlignment="Top" Width="90"/>
            <ComboBox x:Name="COMStartBitsComboBox" 
                      ItemsSource="{Binding Source={StaticResource PortSettingsViewModel}, Mode=OneTime}"
                      SelectedValue="{Binding SerialPort.Settings.SelectedParityBits, UpdateSourceTrigger=PropertyChanged}"
                      HorizontalAlignment="Left" Margin="112,147,0,0" VerticalAlignment="Top" Width="90"/>
        </Grid>
        <Grid Margin="323,0,0,380">
            <GroupBox Header="Сообщения" Margin="0,0,0,40">
                <Grid>
                    <TextBox Text="a"
                         FontSize="12"
                         IsReadOnly="true"
                         Margin="0,0,0,0"/>
                </Grid>
            </GroupBox>
            <Grid VerticalAlignment="Bottom" Height="40">
                <Button x:Name="SendButton" Content="Отправить" HorizontalAlignment="Left" VerticalAlignment="Center" Height="30" Width="137"/>
                <TextBox x:Name="COMInputTextBox" Margin="200,0,6,0" TextWrapping="Wrap" Text="" VerticalAlignment="Center" Height="30"/>
            </Grid>
        </Grid>
    </Grid>
</Window>